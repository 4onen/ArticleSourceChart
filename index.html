<!DOCTYPE html>
<html>
    <head>
        <title id="title">Article Source Chart</title>
        <meta charset='utf-8' />
        <link rel="stylesheet" type="text/css" href="style.css">
        <script type="text/javascript" src="main.js"></script>
    </head>
    <body>
        <div id="ElmApp"></div>
        <script type="text/javascript">
            var app = Elm.Main.embed(document.getElementById("ElmApp"));

            var CLIENT_ID = "76504421127-vsvnp127mbr6e0bp2o4d41is58ohcbpc.apps.googleusercontent.com";
            var API_KEY = '';
            var oauthToken;

            var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];

            var SCOPES = 'https://www.googleapis.com/auth/drive.file';

            function ongapiLoad() {
                app.ports.gapiloaded.send(true)
                gapi.load('client:auth2', initClient);
            }

            function initClient() {
                gapi.client.init({
                    clientId: CLIENT_ID,
                    discoveryDocs: DISCOVERY_DOCS,
                    scope: SCOPES
                }).then(function () {
                    // Listen for sign-in state changes.
                    gapi.auth2.getAuthInstance().isSignedIn.listen(app.ports.updateSigninStatus.send);

                    // Handle the initial sign-in state.
                    app.ports.updateSigninStatus.send(gapi.auth2.getAuthInstance().isSignedIn.get());

                    app.ports.signinStatusClick.subscribe(function(authResult){
                        console.log(authResult);
                        //intoAcc signs in if true, out if false.
                        if(authResult && !authResult.error) {
                            gapi.auth2.getAuthInstance().signIn();
                        }else{
                            gapi.auth2.getAuthInstance().signOut();
                        }
                    })
                });
            }
        </script>
        <script type="text/javascript" src="https://apis.google.com/js/api.js" 
            onload="this.onload=function(){};ongapiLoad();" 
            onreadystatechange="if (this.readyState === 'complete') this.onload()">
        </script>
    </body>
</html>